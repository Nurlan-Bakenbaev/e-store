"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[440],{6440:(e,a,t)=>{t.d(a,{A:()=>v});var s=t(5155),o=t(2115),c=t(6394),l=t(3785),r=t(6417),i=t(7753),n=t(865),d=t(8474),u=t(5565),p=t(9675),g=t(3625),h=t(9005),m=t(1068),x=t(8197);let v=e=>{let{product:a,index:t,size:v}=e,[y,f]=(0,o.useState)(!1),[A,w]=(0,o.useState)(!0),{addToCart:j,getCartItems:C}=(0,x.x)(),{user:R}=(0,h.k)(),[N,b]=(0,o.useState)(!0),_=async e=>{b(!0),R||m.oR.error("Please login to add to cart"),await j(e),m.oR.success("Product added to cart",{autoClose:4e3}),C()};return(0,o.useEffect)(()=>{R&&b(null==R?void 0:R.cartItems.some(e=>e.product.toString()===a._id)),C()},[null==R?void 0:R.cartItems,null==a?void 0:a._id,C,R]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(p.P.div,{variants:{hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{delay:.2*t,duration:.5}}},initial:"hidden",animate:"visible",className:"bg-slate-800 overflow-hidden  hover:bg-slate-700 py-4 rounded-md \n        shadow-md  ".concat(v?"max-w-xs":" max-w-md min-w-[120px]"," flex flex-col \n        sm:flex-").concat(v?"col":"row"," items-center gap-4 group"),children:[(0,s.jsx)("div",{onClick:()=>{f(!0)},className:"cursor-pointer",children:(0,s.jsx)(u.default,{height:180,width:320,src:a.image,alt:"photo of "+a.name,className:"group-hover:scale-105 duration-300 ease-in-out ".concat(v?"w-[180px] h-[180px]":"min-w-[180px] max-h-[320px]"," object-cover")})}),(0,s.jsxs)("div",{className:"flex flex-col gap-2 p-2",children:[(0,s.jsx)("h3",{className:"text-".concat(v?"md":"lg"," font-semibold text-white"),children:a.name}),!v&&(0,s.jsxs)("span",{className:"capitalize text-gray-400",children:["Category: ",a.category]}),v?"":(0,s.jsxs)("div",{className:"text-gray-400",children:["Description:",(0,s.jsx)("div",{onClick:()=>{w(!A)},className:"text-sm text-gray-200 cursor-pointer",children:A?(0,s.jsxs)(s.Fragment,{children:[(0,g.E)(a.description,100),(0,s.jsx)("span",{className:"text-accent",children:"read more"})]}):a.description})]}),(0,s.jsx)("div",{className:"w-full h-[1px] bg-gray-500 my-2"}),(0,s.jsxs)("p",{className:"text-".concat(v?"sm":"lg"," font-bold  text-right"),children:[(0,s.jsx)("span",{children:"Price:"}),(0,s.jsxs)("span",{children:[" $",a.price.toFixed(2)]})]}),(0,s.jsx)("div",{className:"flex items-center justify-between text-sm text-gray-500",children:a.isFeatured&&(0,s.jsxs)("div",{className:"flex items-center gap-1 text-yellow-500",children:[(0,s.jsx)(n.A,{size:16})," ",(0,s.jsx)("span",{children:"Featured"})]})}),(0,s.jsx)("div",{className:"flex items-center justify-between mt-auto",children:(0,s.jsxs)(c.A,{onClick:()=>{_(a)},variant:"contained",color:"success",className:"flex items-center gap-2 text-".concat(v?"sm":"md"," "),children:[(0,s.jsx)(d.A,{size:18}),N?"Added to cart":"Add to cart"]})})]})]}),(0,s.jsxs)(l.A,{open:y,onClose:()=>{f(!1)},fullWidth:!0,maxWidth:"sm",PaperProps:{style:{color:"black",borderRadius:"10px",overflow:"hidden"}},children:[(0,s.jsxs)(r.A,{children:["Product title : ",a.name]}),(0,s.jsx)(i.A,{children:(0,s.jsx)("div",{className:"flex flex-col items-center",children:(0,s.jsx)(u.default,{height:500,width:500,src:a.image,alt:"photo of "+a.name,className:"rounded-md"})})})]})]})}},4922:(e,a,t)=>{t.d(a,{A:()=>s});let s=t(2651).A.create({baseURL:"http://localhost:2000/api",headers:{"Content-Type":"application/json"},withCredentials:!0})},3625:(e,a,t)=>{t.d(a,{E:()=>s});let s=(e,a)=>(null==e?void 0:e.length)>a?e.substring(0,a)+"... ":e},8197:(e,a,t)=>{t.d(a,{x:()=>l});var s=t(9827),o=t(4922),c=t(1068);let l=(0,s.v)((e,a)=>({cart:[],coupon:null,total:0,subtotal:0,isCouponApplied:!1,isLoadingId:null,recomendations:[],getMyCoupon:async()=>{try{let a=await o.A.get("/coupons");e({coupon:a.data.coupon})}catch(e){var a,t;c.oR.error((null===(t=e.response)||void 0===t?void 0:null===(a=t.data)||void 0===a?void 0:a.message)||"Failed to get coupon")}},applyCoupon:async t=>{try{let s=await o.A.post("/coupons/validate",{code:t});e({coupon:s.data,isCouponApplied:!0}),a().calculateTotals(),c.oR.success("Coupon applied successfully")}catch(e){var s,l;c.oR.error((null===(l=e.response)||void 0===l?void 0:null===(s=l.data)||void 0===s?void 0:s.message)||"Failed to apply coupon")}},removeCoupon:()=>{e({coupon:null,isCouponApplied:!1}),a().calculateTotals(),c.oR.success("Coupon removed")},getCartItems:async()=>{try{let t=await o.A.get("/cart/get");e({cart:t.data.cartItems||[]}),a().calculateTotals()}catch(a){e({cart:[]}),c.oR.error(a.response.data.message||"An error occurred")}},clearCart:async()=>{e({cart:[],coupon:null,total:0,subtotal:0})},addToCart:async t=>{try{await o.A.post("/cart/add",{productId:t._id}),e(e=>({cart:e.cart.find(e=>e._id===t._id)?e.cart.map(e=>e._id===t._id?{...e,quantity:e.quantity+1}:e):[...e.cart,{...t,quantity:1}]})),a().calculateTotals()}catch(e){c.oR.error(e.response.data.message||"An error occurred")}},deleteFromCart:async t=>{try{e({isLoadingId:t._id}),e(e=>({cart:e.cart.filter(e=>e._id!==t.id)})),await o.A.delete("/cart/delete",{data:{productId:t._id}}),e({isLoadingId:null}),a().calculateTotals(),a().getCartItems()}catch(e){c.oR.error(e.response.data.message||"An error occurred")}},updateQuantity:async t=>{try{e(e=>({cart:e.cart.map(e=>e._id===t._id?{...e,quantity:t.quantity}:e)})),await o.A.put("/cart/update/".concat(t._id)),a().calculateTotals(),a().getCartItems()}catch(e){}},calculateTotals:()=>{let{cart:t,coupon:s}=a(),o=t.reduce((e,a)=>e+a.price*a.quantity,0),c=o;if(s){let e=o*(s.discountPercentage/100);c=o-e}e({subtotal:o,total:c})},deleteCartOnPurchase:async()=>{try{await o.A.delete("/cart/on-success/delete"),c.oR.success("Cart cleared")}catch(e){c.oR.error(e.message),console.log(e)}},fetchRecomendation:async()=>{try{let a=await o.A.get("/products/get/recommendations");e({recomendations:a.data}),console.log(a.data)}catch(e){console.log(e),c.oR.error(e.message)}}}))},9005:(e,a,t)=>{t.d(a,{k:()=>l});var s=t(9827),o=t(4922),c=t(1068);let l=(0,s.v)((e,a)=>({user:null,loading:!1,checkingAuth:!1,signup:async a=>{let{name:t,email:s,password:l}=a;e({loading:!0});try{let a=await o.A.post("/auth/signup",{name:t,email:s,password:l});c.oR.success(a.data||"Signup successful"),e({user:a.data.user,loading:!1})}catch(a){var r,i,n;e({loading:!1}),(null===(r=a.response)||void 0===r?void 0:r.status)===400?c.oR.error("User already exists"):c.oR.error((null===(n=a.response)||void 0===n?void 0:null===(i=n.data)||void 0===i?void 0:i.message)||"Signup failed")}},login:async a=>{let{email:t,password:s}=a;e({loading:!0});try{let a=await o.A.post("/auth/login",{email:t,password:s});c.oR.success("You are logged in as ".concat(a.data.user.role)),e({user:a.data.user,loading:!1})}catch(a){var l,r;e({loading:!1}),c.oR.error((null===(r=a.response)||void 0===r?void 0:null===(l=r.data)||void 0===l?void 0:l.message)||"Login failed")}},checkAuth:async()=>{e({checkingAuth:!0});try{let a=await o.A.get("/auth/profile");e({user:a.data.user,checkingAuth:!1}),e({loading:!1})}catch(a){e({user:null,checkingAuth:!1}),e({loading:!1})}},logout:async()=>{e({loading:!0});try{await o.A.post("/auth/logout"),c.oR.success("Logout successful"),e({user:null,loading:!1})}catch(s){var a,t;e({loading:!1}),c.oR.error((null===(t=s.response)||void 0===t?void 0:null===(a=t.data)||void 0===a?void 0:a.message)||"Logout failed")}}}))}}]);